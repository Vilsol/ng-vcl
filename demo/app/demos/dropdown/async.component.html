
<h3>vcl-dropdown with async data</h3>

<vcl-embedded-input-group prepIcon="fas:search">
  <input #inputBooks 
         vclEmbeddedInputGroup 
         placeholder="Search Google Books api" 
         (input)="search$.next($event.target.value)"
         [vclDropdown]="dropdownBooks"
         [vclDropdownDisabled]="search.state === 'cleared'"
         [vclDropdownMapValue]="'void'"
         (vclDropdownSelect)="onSelectBook($event)"
         />
  <button vcl-embedded-input-group 
          (click)="inputBooks.value = ''; inputBooks.focus(); search$.next('')" 
          [icon]="'fas:times-circle'">
  </button>
</vcl-embedded-input-group>

<vcl-dropdown #dropdownBooks="vclDropdown">
  <vcl-busy-indicator *ngIf="search.state === 'loading'" style="padding: 1em"></vcl-busy-indicator>
  <div *ngIf="search.state === 'success' && search.books.length === 0" style="padding: 1em">No books found</div>
  <ng-container *ngIf="search.state === 'success' && search.books.length > 0">
    <vcl-dropdown-label-item *ngFor="let book of search.books" [value]="book">{{book.title}}</vcl-dropdown-label-item>
  </ng-container>
</vcl-dropdown>

<ng-container *ngIf="books.length > 0">

  <h3>Books ({{books.length}})</h3>

  <div class="vclDataList vclItemSelectability vclItemHoverHighlight vclNoBorder vclScrollable vclY" style="max-height: 20em;">
    <ul class="vclDataListBody" role="listbox" aria-multiselectable="false">
      <li *ngFor="let book of books" class="vclDataListItem vclLayoutHorizontal" role="option" aria-selected="false">
        <div>
          <img class="vclResponsiveImage" [src]="book.image">
        </div>
        <div class="vclGutterMargin vclLayoutFlex">
          <div class="vclLayoutHorizontal">
            <div class="vclLayoutHorizontal vclLayoutCenter vclLayoutFlex">
              <h2 class="vclNoMargin">{{book.title}}</h2>
            </div>
            <div class="vclSecondaryTextColor vclAlignRight">
              <i>{{book.date}}</i><br>
              <span>{{book.author}}</span>
            </div>
          </div>
        </div>
      </li>
    </ul>
  </div>

  <button vcl-button (click)="onClearBooks()">Clear</button>

</ng-container>
